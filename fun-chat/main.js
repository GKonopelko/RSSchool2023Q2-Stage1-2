(()=>{"use strict";var e,n,t,o,a={d:(e,n)=>{for(var t in n)a.o(n,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},o:(e,n)=>Object.prototype.hasOwnProperty.call(e,n)};function r(e,n){var t=e.querySelector(n);if(null===t)throw new Error("Element not found");return t}a.d({},{s:()=>N});var s,i,l='\n<div><input type="text" id="searchInput" placeholder="Search by name"></div>\n<ul id="userList"></ul>\n';function u(){var e=document.createElement("div");return e.innerHTML=l,t=r(e,"#searchInput"),o=r(e,"#userList"),{formRootNode:e,userSearchInput:t,userList:o}}function d(e){var n=u(),t=n.formRootNode,o=n.userSearchInput,a=n.userList;i.append(t),o.addEventListener("input",(function(e){e.preventDefault(),console.log(o.value),console.log(a)}))}var c,p;function v(){(s=document.createElement("div")).innerHTML='\n  <container>\n  <main>\n  <div class="main__users" id="usersDiv"> Users  </div>\n  <div class="main__chat" id="chatDiv"> Chat  </div>\n  </main>\n  <footer class="footer">\n      <div>\n        <a href="https://github.com/GKonopelko" class="link"\n          >GKonopelko</a>\n      </div>\n      <div><span>2024</span></div>\n      <div><a href=" https://rs.school/js" class="link"> RSSchool</a></div>\n    </footer>   \n  </container>\n  ',p.append(s),i=r(document,"#usersDiv"),r(document,"#chatDiv"),console.log("hi"),N.addEventListener("open",(function(e){d()})),N.addEventListener("message",(function(e){})),d(),function(){var t,o=document.querySelector("#userList");if(null==o)throw Error("Not found");N.send((t={id:crypto.randomUUID(),type:"USER_ACTIVE",payload:null},JSON.stringify(t))),N.onmessage=function(t){if(null==t)throw Error("Not found");JSON.parse(t.data).payload.users.forEach((function(n){e=n.login;var t=n.isLogined;if(null==t)throw Error("Not found");null!=e&&(o.innerHTML+='\n      <li class="user__line"><span class="user__status '.concat(t,'">*</span><span class="user__login">').concat(e,"</span></li>\n      "))}));var a=document.querySelectorAll(".user__line");if(null==a)throw Error("Not found");a.forEach((function(e){e.addEventListener("click",(function(t){t.preventDefault();var o=r(e,".user__login");n=o.innerHTML,console.log(n)}))}))}}()}var f="",m=function(e){return'\n    <header>\n    <div class="header__title">\n     <span> <b>Fun Chat</b></span>\n     <div>User: '.concat(e,'</div>\n    </div> \n    <button id="logoutButton" class="active">Log out</button>\n    </header>\n    ')};function h(){if((p=document.createElement("div")).innerHTML=m(f),null===p)throw new Error("Element not found");return c=r(p,"#logoutButton"),{headerRootNode:p,buttonLogout:c}}var g,L,w,E,b=new WebSocket("ws://localhost:4000"),y=(b.addEventListener("message",(function(e){if(null==(E=JSON.parse(e.data).payload.user))throw Error("Not found");y=E})),y),T="\n<h1>".concat("Fun Chat","</h1>\n<p>").concat("Please, enter your username and password",'</p>\n<form>\n<label for="username">Username</label>\n<input type="text" id="username" required>\n<span class="tooltip" id="usernameTooltip"> </span>\n<label for="password">Password</label>\n<input type="text" id="password" required>\n<span class="tooltip" id="passwordTooltip"> </span>\n<button id="loginButton">Log in</button>\n</form>\n');function S(){(w=document.createElement("div")).innerHTML=T,g=r(w,"#username"),L=r(w,"#password");var e=r(w,"#loginButton"),n=r(w,"#usernameTooltip"),t=r(w,"#passwordTooltip");return{formRootNode:w,usernameInput:g,passwordInput:L,buttonLogin:e,usernameTooltip:n,passwordTooltip:t}}var N=new WebSocket("ws://localhost:4000");b.addEventListener("open",(function(e){!function(e){var n=S(),t=n.formRootNode,o=n.usernameInput,a=n.passwordInput,r=n.buttonLogin,s=n.usernameTooltip,i=n.passwordTooltip;document.body.append(t),t.classList.add("active"),t.setAttribute("id","loginBlock"),t.addEventListener("input",(function(e){e.preventDefault(),s.innerHTML="",i.innerHTML="",r.classList.remove("active");var n=/^[A-Z][a-z-]*$/,t=/^[A-Za-z0-9]+$/;o.value.length<3&&(s.innerHTML+=" Minimum length 3 characters. "),n.test(o.value)||(s.innerHTML+=" English alphabet letters and first letter in uppercase. "),t.test(a.value)||(i.innerHTML+=" English alphabet letters and numbers. "),a.value.length<5&&(i.innerHTML+=" Minimum length 5 characters. "),o.value.length>=3&&a.value.length>=5&&t.test(a.value)&&n.test(o.value)&&(r.classList.add("active"),s.innerHTML="",i.innerHTML="")})),r.addEventListener("click",(function(n){n.preventDefault();var s=o.value,i=a.value;r.classList.contains("active")&&(e.send(function(e){var n=e.login,t=e.password,o={id:crypto.randomUUID(),type:"USER_LOGIN",payload:{user:{login:n,password:t}}};return JSON.stringify(o)}({login:s,password:i})),sessionStorage.setItem("currentUser",s),console.log(s,i),o.value="",a.value="",t.classList.remove("active"))}))}(b)})),b.addEventListener("message",(function(e){console.log("event.data"),console.log(e.data);var n=JSON.parse(e.data).payload.user;if(null==n.isLogined)throw Error("Not found");!function(e){console.log(e),f=e;var n=new WebSocket("ws://localhost:4000");n.addEventListener("open",(function(e){p?p.classList.add("active"):function(e){var n=h(),t=n.headerRootNode,o=n.buttonLogout;document.body.append(t),t.classList.add("active"),t.setAttribute("id","headerBlock"),o.addEventListener("click",(function(n){var o,a,r,s;n.preventDefault(),t.classList.remove("active"),w.classList.add("active"),e.send((a=(o={login:"взять из сокета",password:"взять из сокета"}).login,r=o.password,s={id:crypto.randomUUID(),type:"USER_LOGOUT",payload:{user:{login:a,password:r}}},console.log("logoutMessage",s),JSON.stringify(s)))}))}(n),s?s.classList.add("active"):v()})),n.addEventListener("message",(function(e){return JSON.parse(e.data).payload.user}))}(n.login)}))})();